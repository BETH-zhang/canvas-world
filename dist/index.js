!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("prop-types"),require("react")):"function"==typeof define&&define.amd?define(["prop-types","react"],e):"object"==typeof exports?exports["canvas-world"]=e(require("prop-types"),require("react")):t["canvas-world"]=e(t[void 0],t[void 0])}(window,function(t,e){return function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:s})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=17)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(e,n){e.exports=t},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,n){var s=n(29),r=n(28),i=n(27);t.exports=function(t){return s(t)||r(t)||i()}},function(t,n){t.exports=e},function(t,e,n){var s=n(24),r=n(14),i="[object AsyncFunction]",a="[object Function]",o="[object GeneratorFunction]",h="[object Proxy]";t.exports=function(t){if(!r(t))return!1;var e=s(t);return e==a||e==o||e==i||e==h}},function(t,e,n){var s=n(25);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var s=n(26),r=n(4);t.exports=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?r(t):e}},function(t,e,n){t.exports=function(){"use strict";const t="undefined"!=typeof self;class e{constructor(t,e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1},this.config=t||{},this.surface=e,this.config.options&&(this.defaultOptions=this._options(this.config.options))}_options(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_drawable(t,e,n){return{shape:t,sets:e||[],options:n||this.defaultOptions}}getCanvasSize(){const t=t=>t&&"object"==typeof t&&t.baseVal&&t.baseVal.value?t.baseVal.value:t||100;return this.surface?[t(this.surface.width),t(this.surface.height)]:[100,100]}computePolygonSize(t){if(t.length){let e=t[0][0],n=t[0][0],s=t[0][1],r=t[0][1];for(let i=1;i<t.length;i++)e=Math.min(e,t[i][0]),n=Math.max(n,t[i][0]),s=Math.min(s,t[i][1]),r=Math.max(r,t[i][1]);return[n-e,r-s]}return[0,0]}polygonPath(t){let e="";if(t.length){e=`M${t[0][0]},${t[0][1]}`;for(let n=1;n<t.length;n++)e=`${e} L${t[n][0]},${t[n][1]}`}return e}computePathSize(e){let n=[0,0];if(t&&self.document)try{const t="http://www.w3.org/2000/svg",s=self.document.createElementNS(t,"svg");s.setAttribute("width","0"),s.setAttribute("height","0");const r=self.document.createElementNS(t,"path");r.setAttribute("d",e),s.appendChild(r),self.document.body.appendChild(s);const i=r.getBBox();i&&(n[0]=i.width||0,n[1]=i.height||0),self.document.body.removeChild(s)}catch(t){}const s=this.getCanvasSize();return n[0]*n[1]||(n=s),n}toPaths(t){const e=t.sets||[],n=t.options||this.defaultOptions,s=[];for(const t of e){let e=null;switch(t.type){case"path":e={d:this.opsToPath(t),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:"none"};break;case"fillPath":e={d:this.opsToPath(t),stroke:"none",strokeWidth:0,fill:n.fill||"none"};break;case"fillSketch":e=this.fillSketch(t,n);break;case"path2Dfill":e={d:t.path||"",stroke:"none",strokeWidth:0,fill:n.fill||"none"};break;case"path2Dpattern":{const s=t.size,r={x:0,y:0,width:1,height:1,viewBox:`0 0 ${Math.round(s[0])} ${Math.round(s[1])}`,patternUnits:"objectBoundingBox",path:this.fillSketch(t,n)};e={d:t.path,stroke:"none",strokeWidth:0,pattern:r};break}}e&&s.push(e)}return s}fillSketch(t,e){let n=e.fillWeight;return n<0&&(n=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||"none",strokeWidth:n,fill:"none"}}opsToPath(t){let e="";for(const n of t.ops){const t=n.data;switch(n.op){case"move":e+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":e+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"qcurveTo":e+=`Q${t[0]} ${t[1]}, ${t[2]} ${t[3]} `;break;case"lineTo":e+=`L${t[0]} ${t[1]} `}}return e.trim()}}function n(t,e){return e=e||[],new Proxy(function(){},{get(s,r,i){if("then"===r){if(0===e.length)return{then:()=>i};const n=t.remote({type:"GET",path:e});return n.then.bind(n)}return n(t,e.concat(r))},set:(n,s,r)=>t.remote({type:"SET",path:e.concat(s),value:r}),apply:(n,s,r)=>t.remote({type:"APPLY",path:e,args:r}),construct:(e,n)=>t.remote({type:"CONSTRUCT",args:n})})}class s{constructor(t,e){this.w=t,this.uid=e||`${Date.now()}-${r()}`,this.c=0,this.cbs={},t.addEventListener("message",e=>{if(this.w.oURL)try{URL.revokeObjectURL(this.w.oURL)}catch(t){}finally{delete this.w.oURL}let r=e.data&&e.data.id,i=r&&this.cbs[r];i&&(delete this.cbs[r],e.data.error?i[1](new Error(e.data.error)):i[0](e.data.targetId?n(new s(t,e.data.targetId)):e.data.value))})}remote(t){const e=t.args||[],n=`${this.uid}-${++this.c}`;return new Promise((s,r)=>{this.cbs[n]=[s,r],this.w.postMessage(Object.assign({},t,{id:n,args:e,target:this.uid}))})}}function r(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)}function i(t){const e=t,n={};self.addEventListener("message",async t=>{let s=t.data||{};s.path=s.path||[];let i=s.target&&n[s.target]||e;const a=t=>t.reduce((t,e)=>t?t[e]:t,i),o=s&&s.id;if(o&&s.type){const t={id:o},e=a(s.path),i=a(s.path.slice(0,-1));switch(s.type){case"GET":t.value=e;break;case"SET":let a=s.path.length&&s.path[s.path.length-1];a&&(i[a]=s.value),t.value=!!a;break;case"APPLY":try{t.value=await e.apply(i,s.args||[])}catch(e){t.error=e.toString()}break;case"CONSTRUCT":try{t.value=new e(...s.args),t.targetId=(t=>{const e=`${Date.now()}-${r()}`;return n[e]=t,e})(t.value)}catch(e){t.error=e.toString()}}self.postMessage(t)}})}function a(t,e){return t.type===e}const o={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:4,t:2,V:1,v:1,Z:0,z:0};class h{constructor(t){this.COMMAND=0,this.NUMBER=1,this.EOD=2,this.segments=[],this.parseData(t),this.processPoints()}tokenize(t){const e=new Array;for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:this.COMMAND,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return console.error("Unrecognized segment command: "+t),[];e[e.length]={type:this.NUMBER,text:`${parseFloat(RegExp.$1)}`},t=t.substr(RegExp.$1.length)}return e[e.length]={type:this.EOD,text:""},e}parseData(t){const e=this.tokenize(t);let n=0,s=e[n],r="BOD";for(this.segments=new Array;!a(s,this.EOD);){let i;const h=new Array;if("BOD"===r){if("M"!==s.text&&"m"!==s.text)return void this.parseData("M0,0"+t);n++,i=o[s.text],r=s.text}else a(s,this.NUMBER)?i=o[r]:(n++,i=o[s.text],r=s.text);if(n+i<e.length){for(let t=n;t<n+i;t++){const n=e[t];if(!a(n,this.NUMBER))return void console.error("Parameter type is not a number: "+r+","+n.text);h[h.length]=+n.text}if("number"!=typeof o[r])return void console.error("Unsupported segment type: "+r);{const t={key:r,data:h};this.segments.push(t),s=e[n+=i],"M"===r&&(r="L"),"m"===r&&(r="l")}}else console.error("Path data ended before all parameters were found")}}get closed(){if(void 0===this._closed){this._closed=!1;for(const t of this.segments)"z"===t.key.toLowerCase()&&(this._closed=!0)}return this._closed}processPoints(){let t=null,e=[0,0];for(let n=0;n<this.segments.length;n++){const s=this.segments[n];switch(s.key){case"M":case"L":case"T":s.point=[s.data[0],s.data[1]];break;case"m":case"l":case"t":s.point=[s.data[0]+e[0],s.data[1]+e[1]];break;case"H":s.point=[s.data[0],e[1]];break;case"h":s.point=[s.data[0]+e[0],e[1]];break;case"V":s.point=[e[0],s.data[0]];break;case"v":s.point=[e[0],s.data[0]+e[1]];break;case"z":case"Z":t&&(s.point=[t[0],t[1]]);break;case"C":s.point=[s.data[4],s.data[5]];break;case"c":s.point=[s.data[4]+e[0],s.data[5]+e[1]];break;case"S":s.point=[s.data[2],s.data[3]];break;case"s":s.point=[s.data[2]+e[0],s.data[3]+e[1]];break;case"Q":s.point=[s.data[2],s.data[3]];break;case"q":s.point=[s.data[2]+e[0],s.data[3]+e[1]];break;case"A":s.point=[s.data[5],s.data[6]];break;case"a":s.point=[s.data[5]+e[0],s.data[6]+e[1]]}"m"!==s.key&&"M"!==s.key||(t=null),s.point&&(e=s.point,t||(t=s.point)),"z"!==s.key&&"Z"!==s.key||(t=null)}}}class c{constructor(t){this._position=[0,0],this._first=null,this.bezierReflectionPoint=null,this.quadReflectionPoint=null,this.parsed=new h(t)}get segments(){return this.parsed.segments}get closed(){return this.parsed.closed}get linearPoints(){if(!this._linearPoints){const t=[];let e=[];for(const n of this.parsed.segments){const s=n.key.toLowerCase();("m"!==s&&"z"!==s||(e.length&&(t.push(e),e=[]),"z"!==s))&&n.point&&e.push(n.point)}e.length&&(t.push(e),e=[]),this._linearPoints=t}return this._linearPoints}get first(){return this._first}set first(t){this._first=t}setPosition(t,e){this._position=[t,e],this._first||(this._first=[t,e])}get position(){return this._position}get x(){return this._position[0]}get y(){return this._position[1]}}class l{constructor(t,e,n,s,r,i){if(this._segIndex=0,this._numSegs=0,this._rx=0,this._ry=0,this._sinPhi=0,this._cosPhi=0,this._C=[0,0],this._theta=0,this._delta=0,this._T=0,this._from=t,t[0]===e[0]&&t[1]===e[1])return;const a=Math.PI/180;this._rx=Math.abs(n[0]),this._ry=Math.abs(n[1]),this._sinPhi=Math.sin(s*a),this._cosPhi=Math.cos(s*a);const o=this._cosPhi*(t[0]-e[0])/2+this._sinPhi*(t[1]-e[1])/2,h=-this._sinPhi*(t[0]-e[0])/2+this._cosPhi*(t[1]-e[1])/2;let c=0;const l=this._rx*this._rx*this._ry*this._ry-this._rx*this._rx*h*h-this._ry*this._ry*o*o;if(l<0){const t=Math.sqrt(1-l/(this._rx*this._rx*this._ry*this._ry));this._rx=this._rx*t,this._ry=this._ry*t,c=0}else c=(r===i?-1:1)*Math.sqrt(l/(this._rx*this._rx*h*h+this._ry*this._ry*o*o));const u=c*this._rx*h/this._ry,p=-c*this._ry*o/this._rx;this._C=[0,0],this._C[0]=this._cosPhi*u-this._sinPhi*p+(t[0]+e[0])/2,this._C[1]=this._sinPhi*u+this._cosPhi*p+(t[1]+e[1])/2,this._theta=this.calculateVectorAngle(1,0,(o-u)/this._rx,(h-p)/this._ry);let f=this.calculateVectorAngle((o-u)/this._rx,(h-p)/this._ry,(-o-u)/this._rx,(-h-p)/this._ry);!i&&f>0?f-=2*Math.PI:i&&f<0&&(f+=2*Math.PI),this._numSegs=Math.ceil(Math.abs(f/(Math.PI/2))),this._delta=f/this._numSegs,this._T=8/3*Math.sin(this._delta/4)*Math.sin(this._delta/4)/Math.sin(this._delta/2)}getNextSegment(){if(this._segIndex===this._numSegs)return null;const t=Math.cos(this._theta),e=Math.sin(this._theta),n=this._theta+this._delta,s=Math.cos(n),r=Math.sin(n),i=[this._cosPhi*this._rx*s-this._sinPhi*this._ry*r+this._C[0],this._sinPhi*this._rx*s+this._cosPhi*this._ry*r+this._C[1]],a=[this._from[0]+this._T*(-this._cosPhi*this._rx*e-this._sinPhi*this._ry*t),this._from[1]+this._T*(-this._sinPhi*this._rx*e+this._cosPhi*this._ry*t)],o=[i[0]+this._T*(this._cosPhi*this._rx*r+this._sinPhi*this._ry*s),i[1]+this._T*(this._sinPhi*this._rx*r-this._cosPhi*this._ry*s)];return this._theta=n,this._from=[i[0],i[1]],this._segIndex++,{cp1:a,cp2:o,to:i}}calculateVectorAngle(t,e,n,s){const r=Math.atan2(e,t),i=Math.atan2(s,n);return i>=r?i-r:2*Math.PI-(r-i)}}class u{constructor(t,e){this.xi=Number.MAX_VALUE,this.yi=Number.MAX_VALUE,this.px1=t[0],this.py1=t[1],this.px2=e[0],this.py2=e[1],this.a=this.py2-this.py1,this.b=this.px1-this.px2,this.c=this.px2*this.py1-this.px1*this.py2,this._undefined=0===this.a&&0===this.b&&0===this.c}isUndefined(){return this._undefined}intersects(t){if(this.isUndefined()||t.isUndefined())return!1;let e=Number.MAX_VALUE,n=Number.MAX_VALUE,s=0,r=0;const i=this.a,a=this.b,o=this.c;return Math.abs(a)>1e-5&&(e=-i/a,s=-o/a),Math.abs(t.b)>1e-5&&(n=-t.a/t.b,r=-t.c/t.b),e===Number.MAX_VALUE?n===Number.MAX_VALUE?-o/i==-t.c/t.a&&(this.py1>=Math.min(t.py1,t.py2)&&this.py1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.py2>=Math.min(t.py1,t.py2)&&this.py2<=Math.max(t.py1,t.py2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=this.px1,this.yi=n*this.xi+r,!((this.py1-this.yi)*(this.yi-this.py2)<-1e-5||(t.py1-this.yi)*(this.yi-t.py2)<-1e-5||Math.abs(t.a)<1e-5&&(t.px1-this.xi)*(this.xi-t.px2)<-1e-5)):n===Number.MAX_VALUE?(this.xi=t.px1,this.yi=e*this.xi+s,!((t.py1-this.yi)*(this.yi-t.py2)<-1e-5||(this.py1-this.yi)*(this.yi-this.py2)<-1e-5||Math.abs(i)<1e-5&&(this.px1-this.xi)*(this.xi-this.px2)<-1e-5)):e===n?s===r&&(this.px1>=Math.min(t.px1,t.px2)&&this.px1<=Math.max(t.py1,t.py2)?(this.xi=this.px1,this.yi=this.py1,!0):this.px2>=Math.min(t.px1,t.px2)&&this.px2<=Math.max(t.px1,t.px2)&&(this.xi=this.px2,this.yi=this.py2,!0)):(this.xi=(r-s)/(e-n),this.yi=e*this.xi+s,!((this.px1-this.xi)*(this.xi-this.px2)<-1e-5||(t.px1-this.xi)*(this.xi-t.px2)<-1e-5))}}function p(t,e){const n=t[1][1]-t[0][1],s=t[0][0]-t[1][0],r=n*t[0][0]+s*t[0][1],i=e[1][1]-e[0][1],a=e[0][0]-e[1][0],o=i*e[0][0]+a*e[0][1],h=n*a-i*s;return h?[Math.round((a*r-s*o)/h),Math.round((n*o-i*r)/h)]:null}class f{constructor(t,e,n,s,r,i,a,o){this.deltaX=0,this.hGap=0,this.top=t,this.bottom=e,this.left=n,this.right=s,this.gap=r,this.sinAngle=i,this.tanAngle=o,Math.abs(i)<1e-4?this.pos=n+r:Math.abs(i)>.9999?this.pos=t+r:(this.deltaX=(e-t)*Math.abs(o),this.pos=n-Math.abs(this.deltaX),this.hGap=Math.abs(r/a),this.sLeft=new u([n,e],[n,t]),this.sRight=new u([s,e],[s,t]))}nextLine(){if(Math.abs(this.sinAngle)<1e-4){if(this.pos<this.right){const t=[this.pos,this.top,this.pos,this.bottom];return this.pos+=this.gap,t}}else if(Math.abs(this.sinAngle)>.9999){if(this.pos<this.bottom){const t=[this.left,this.pos,this.right,this.pos];return this.pos+=this.gap,t}}else{let t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,n=this.bottom,s=this.top;if(this.pos<this.right+this.deltaX){for(;t<this.left&&e<this.left||t>this.right&&e>this.right;)if(this.pos+=this.hGap,t=this.pos-this.deltaX/2,e=this.pos+this.deltaX/2,this.pos>this.right+this.deltaX)return null;const r=new u([t,n],[e,s]);this.sLeft&&r.intersects(this.sLeft)&&(t=r.xi,n=r.yi),this.sRight&&r.intersects(this.sRight)&&(e=r.xi,s=r.yi),this.tanAngle>0&&(t=this.right-(t-this.left),e=this.right-(e-this.left));const i=[t,n,e,s];return this.pos+=this.hGap,i}}return null}}function d(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}function y(t,e){const n=[],s=new u([t[0],t[1]],[t[2],t[3]]);for(let t=0;t<e.length;t++){const r=new u(e[t],e[(t+1)%e.length]);s.intersects(r)&&n.push([s.xi,s.yi])}return n}function g(t,e,n,s,r,i,a){return[-n*i-s*r+n+i*t+r*e,a*(n*r-s*i)+s+-a*r*t+a*i*e]}function v(t,e){const n=[];if(t&&t.length){let s=t[0][0],r=t[0][0],i=t[0][1],a=t[0][1];for(let e=1;e<t.length;e++)s=Math.min(s,t[e][0]),r=Math.max(r,t[e][0]),i=Math.min(i,t[e][1]),a=Math.max(a,t[e][1]);const o=e.hachureAngle;let h=e.hachureGap;h<0&&(h=4*e.strokeWidth),h=Math.max(h,.1);const c=o%180*(Math.PI/180),l=Math.cos(c),u=Math.sin(c),p=Math.tan(c),d=new f(i-1,a+1,s-1,r+1,h,u,l,p);let g;for(;null!=(g=d.nextLine());){const e=y(g,t);for(let t=0;t<e.length;t++)if(t<e.length-1){const s=e[t],r=e[t+1];n.push([s,r])}}}return n}function x(t,e,n,s,r,i){const a=[];let o=Math.abs(s/2),h=Math.abs(r/2);o+=t.randOffset(.05*o,i),h+=t.randOffset(.05*h,i);const c=i.hachureAngle;let l=i.hachureGap;l<=0&&(l=4*i.strokeWidth);let u=i.fillWeight;u<0&&(u=i.strokeWidth/2);const p=c%180*(Math.PI/180),f=Math.tan(p),d=h/o,y=Math.sqrt(d*f*d*f+1),v=d*f/y,x=1/y,w=l/(o*h/Math.sqrt(h*x*(h*x)+o*v*(o*v))/o);let m=Math.sqrt(o*o-(e-o+w)*(e-o+w));for(let t=e-o+w;t<e+o;t+=w){const s=g(t,n-(m=Math.sqrt(o*o-(e-t)*(e-t))),e,n,v,x,d),r=g(t,n+m,e,n,v,x,d);a.push([s,r])}return a}class w{constructor(t){this.helper=t}fillPolygon(t,e){return this._fillPolygon(t,e)}fillEllipse(t,e,n,s,r){return this._fillEllipse(t,e,n,s,r)}fillArc(t,e,n,s,r,i,a){return null}_fillPolygon(t,e,n=!1){const s=v(t,e);return{type:"fillSketch",ops:this.renderLines(s,e,n)}}_fillEllipse(t,e,n,s,r,i=!1){const a=x(this.helper,t,e,n,s,r);return{type:"fillSketch",ops:this.renderLines(a,r,i)}}renderLines(t,e,n){let s=[],r=null;for(const i of t)s=s.concat(this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],e)),n&&r&&(s=s.concat(this.helper.doubleLineOps(r[0],r[1],i[0][0],i[0][1],e))),r=i[1];return s}}class m extends w{fillPolygon(t,e){return this._fillPolygon(t,e,!0)}fillEllipse(t,e,n,s,r){return this._fillEllipse(t,e,n,s,r,!0)}}class b extends w{fillPolygon(t,e){const n=this._fillPolygon(t,e),s=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),r=this._fillPolygon(t,s);return n.ops=n.ops.concat(r.ops),n}fillEllipse(t,e,n,s,r){const i=this._fillEllipse(t,e,n,s,r),a=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),o=this._fillEllipse(t,e,n,s,a);return i.ops=i.ops.concat(o.ops),i}}class M{constructor(t){this.helper=t}fillPolygon(t,e){const n=v(t,e=Object.assign({},e,{curveStepCount:4,hachureAngle:0}));return this.dotsOnLines(n,e)}fillEllipse(t,e,n,s,r){r=Object.assign({},r,{curveStepCount:4,hachureAngle:0});const i=x(this.helper,t,e,n,s,r);return this.dotsOnLines(i,r)}fillArc(t,e,n,s,r,i,a){return null}dotsOnLines(t,e){let n=[],s=e.hachureGap;s<0&&(s=4*e.strokeWidth),s=Math.max(s,.1);let r=e.fillWeight;r<0&&(r=e.strokeWidth/2);for(const i of t){const t=d(i)/s,a=Math.ceil(t)-1,o=Math.atan((i[1][1]-i[0][1])/(i[1][0]-i[0][0]));for(let t=0;t<a;t++){const a=s*(t+1),h=a*Math.sin(o),c=a*Math.cos(o),l=[i[0][0]-c,i[0][1]+h],u=this.helper.randOffsetWithRange(l[0]-s/4,l[0]+s/4,e),p=this.helper.randOffsetWithRange(l[1]-s/4,l[1]+s/4,e),f=this.helper.ellipse(u,p,r,r,e);n=n.concat(f.ops)}}return{type:"fillSketch",ops:n}}}class _{constructor(t){this.helper=t}fillPolygon(t,e){const n=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],s=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER];t.forEach(t=>{n[0]=Math.min(n[0],t[0]),n[1]=Math.max(n[1],t[0]),s[0]=Math.min(s[0],t[1]),s[1]=Math.max(s[1],t[1])});const r=function(t){let e=0,n=0,s=0;for(let n=0;n<t.length;n++){const s=t[n],r=n===t.length-1?t[0]:t[n+1];e+=s[0]*r[1]-r[0]*s[1]}e/=2;for(let e=0;e<t.length;e++){const r=t[e],i=e===t.length-1?t[0]:t[e+1];n+=(r[0]+i[0])*(r[0]*i[1]-i[0]*r[1]),s+=(r[1]+i[1])*(r[0]*i[1]-i[0]*r[1])}return[n/(6*e),s/(6*e)]}(t),i=Math.max(Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-s[0],2)),Math.sqrt(Math.pow(r[0]-n[1],2)+Math.pow(r[1]-s[1],2))),a=e.hachureGap>0?e.hachureGap:4*e.strokeWidth,o=[];if(t.length>2)for(let e=0;e<t.length;e++)e===t.length-1?o.push([t[e],t[0]]):o.push([t[e],t[e+1]]);let h=[];const c=Math.max(1,Math.PI*i/a);for(let t=0;t<c;t++){const e=t*Math.PI/c,a=[r,[r[0]+i*Math.cos(e),r[1]+i*Math.sin(e)]];o.forEach(t=>{const e=p(t,a);e&&e[0]>=n[0]&&e[0]<=n[1]&&e[1]>=s[0]&&e[1]<=s[1]&&h.push(e)})}h=this.removeDuplocatePoints(h);const l=this.createLinesFromCenter(r,h);return{type:"fillSketch",ops:this.drawLines(l,e)}}fillEllipse(t,e,n,s,r){return this.fillArcSegment(t,e,n,s,0,2*Math.PI,r)}fillArc(t,e,n,s,r,i,a){return this.fillArcSegment(t,e,n,s,r,i,a)}fillArcSegment(t,e,n,s,r,i,a){const o=[t,e],h=n/2,c=s/2,l=Math.max(n/2,s/2);let u=a.hachureGap;u<0&&(u=4*a.strokeWidth);const p=Math.max(1,Math.abs(i-r)*l/u);let f=[];for(let t=0;t<p;t++){const e=t*((i-r)/p)+r,n=l*Math.cos(e),s=l*Math.sin(e),a=Math.sqrt(h*h*s*s+c*c*n*n),u=h*c*n/a,d=h*c*s/a;f.push([o[0]+u,o[1]+d])}f=this.removeDuplocatePoints(f);const d=this.createLinesFromCenter(o,f);return{type:"fillSketch",ops:this.drawLines(d,a)}}drawLines(t,e){let n=[];return t.forEach(t=>{const s=t[0],r=t[1];n=n.concat(this.helper.doubleLineOps(s[0],s[1],r[0],r[1],e))}),n}createLinesFromCenter(t,e){return e.map(e=>[t,e])}removeDuplocatePoints(t){const e=new Set;return t.filter(t=>{const n=t.join(",");return!e.has(n)&&(e.add(n),!0)})}}class P{constructor(t){this.helper=t}fillPolygon(t,e){const n=v(t,e);return{type:"fillSketch",ops:this.dashedLine(n,e)}}fillEllipse(t,e,n,s,r){const i=x(this.helper,t,e,n,s,r);return{type:"fillSketch",ops:this.dashedLine(i,r)}}fillArc(t,e,n,s,r,i,a){return null}dashedLine(t,e){const n=e.dashOffset<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashOffset,s=e.dashGap<0?e.hachureGap<0?4*e.strokeWidth:e.hachureGap:e.dashGap;let r=[];return t.forEach(t=>{const i=d(t),a=Math.floor(i/(n+s)),o=(i+s-a*(n+s))/2;let h=t[0],c=t[1];h[0]>c[0]&&(h=t[1],c=t[0]);const l=Math.atan((c[1]-h[1])/(c[0]-h[0]));for(let t=0;t<a;t++){const i=t*(n+s),a=i+n,c=[h[0]+i*Math.cos(l)+o*Math.cos(l),h[1]+i*Math.sin(l)+o*Math.sin(l)],u=[h[0]+a*Math.cos(l)+o*Math.cos(l),h[1]+a*Math.sin(l)+o*Math.sin(l)];r=r.concat(this.helper.doubleLineOps(c[0],c[1],u[0],u[1],e))}}),r}}class k{constructor(t){this.helper=t}fillPolygon(t,e){const n=e.hachureGap<0?4*e.strokeWidth:e.hachureGap,s=e.zigzagOffset<0?n:e.zigzagOffset,r=v(t,e=Object.assign({},e,{hachureGap:n+s}));return{type:"fillSketch",ops:this.zigzagLines(r,s,e)}}fillEllipse(t,e,n,s,r){const i=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,a=r.zigzagOffset<0?i:r.zigzagOffset;r=Object.assign({},r,{hachureGap:i+a});const o=x(this.helper,t,e,n,s,r);return{type:"fillSketch",ops:this.zigzagLines(o,a,r)}}fillArc(t,e,n,s,r,i,a){return null}zigzagLines(t,e,n){let s=[];return t.forEach(t=>{const r=d(t),i=Math.round(r/(2*e));let a=t[0],o=t[1];a[0]>o[0]&&(a=t[1],o=t[0]);const h=Math.atan((o[1]-a[1])/(o[0]-a[0]));for(let t=0;t<i;t++){const r=2*t*e,i=2*(t+1)*e,o=Math.sqrt(2*Math.pow(e,2)),c=[a[0]+r*Math.cos(h),a[1]+r*Math.sin(h)],l=[a[0]+i*Math.cos(h),a[1]+i*Math.sin(h)],u=[c[0]+o*Math.cos(h+Math.PI/4),c[1]+o*Math.sin(h+Math.PI/4)];s=(s=s.concat(this.helper.doubleLineOps(c[0],c[1],u[0],u[1],n))).concat(this.helper.doubleLineOps(u[0],u[1],l[0],l[1],n))}}),s}}const E={};function S(t,e){let n=t.fillStyle||"hachure";if(!E[n])switch(n){case"zigzag":E[n]||(E[n]=new m(e));break;case"cross-hatch":E[n]||(E[n]=new b(e));break;case"dots":E[n]||(E[n]=new M(e));break;case"starburst":E[n]||(E[n]=new _(e));break;case"dashed":E[n]||(E[n]=new P(e));break;case"zigzag-line":E[n]||(E[n]=new k(e));break;case"hachure":default:E[n="hachure"]||(E[n]=new w(e))}return E[n]}const T={randOffset:z,randOffsetWithRange:D,ellipse:C,doubleLineOps:j};function O(t,e,n,s,r){return{type:"path",ops:N(t,e,n,s,r)}}function L(t,e,n){const s=(t||[]).length;if(s>2){let r=[];for(let e=0;e<s-1;e++)r=r.concat(N(t[e][0],t[e][1],t[e+1][0],t[e+1][1],n));return e&&(r=r.concat(N(t[s-1][0],t[s-1][1],t[0][0],t[0][1],n))),{type:"path",ops:r}}return 2===s?O(t[0][0],t[0][1],t[1][0],t[1][1],n):{type:"path",ops:[]}}function A(t,e){return L(t,!0,e)}function C(t,e,n,s,r){const i=2*Math.PI/r.curveStepCount;let a=Math.abs(n/2),o=Math.abs(s/2);const h=$(i,t,e,a+=F(.05*a,r),o+=F(.05*o,r),1,i*I(.1,I(.4,1,r),r),r),c=$(i,t,e,a,o,1.5,0,r);return{type:"path",ops:h.concat(c)}}function R(t,e){return S(e,T).fillPolygon(t,e)}function z(t,e){return F(t,e)}function D(t,e,n){return I(t,e,n)}function j(t,e,n,s,r){return N(t,e,n,s,r)}function I(t,e,n){return n.roughness*(Math.random()*(e-t)+t)}function F(t,e){return I(-t,t,e)}function N(t,e,n,s,r){const i=W(t,e,n,s,r,!0,!1),a=W(t,e,n,s,r,!0,!0);return i.concat(a)}function W(t,e,n,s,r,i,a){const o=Math.pow(t-n,2)+Math.pow(e-s,2);let h=r.maxRandomnessOffset||0;h*h*100>o&&(h=Math.sqrt(o)/10);const c=h/2,l=.2+.2*Math.random();let u=r.bowing*r.maxRandomnessOffset*(s-e)/200,p=r.bowing*r.maxRandomnessOffset*(t-n)/200;u=F(u,r),p=F(p,r);const f=[],d=()=>F(c,r),y=()=>F(h,r);return i&&(a?f.push({op:"move",data:[t+d(),e+d()]}):f.push({op:"move",data:[t+F(h,r),e+F(h,r)]})),a?f.push({op:"bcurveTo",data:[u+t+(n-t)*l+d(),p+e+(s-e)*l+d(),u+t+2*(n-t)*l+d(),p+e+2*(s-e)*l+d(),n+d(),s+d()]}):f.push({op:"bcurveTo",data:[u+t+(n-t)*l+y(),p+e+(s-e)*l+y(),u+t+2*(n-t)*l+y(),p+e+2*(s-e)*l+y(),n+y(),s+y()]}),f}function G(t,e,n){const s=[];s.push([t[0][0]+F(e,n),t[0][1]+F(e,n)]),s.push([t[0][0]+F(e,n),t[0][1]+F(e,n)]);for(let r=1;r<t.length;r++)s.push([t[r][0]+F(e,n),t[r][1]+F(e,n)]),r===t.length-1&&s.push([t[r][0]+F(e,n),t[r][1]+F(e,n)]);return q(s,null,n)}function q(t,e,n){const s=t.length;let r=[];if(s>3){const i=[],a=1-n.curveTightness;r.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;e+2<s;e++){const n=t[e];i[0]=[n[0],n[1]],i[1]=[n[0]+(a*t[e+1][0]-a*t[e-1][0])/6,n[1]+(a*t[e+1][1]-a*t[e-1][1])/6],i[2]=[t[e+1][0]+(a*t[e][0]-a*t[e+2][0])/6,t[e+1][1]+(a*t[e][1]-a*t[e+2][1])/6],i[3]=[t[e+1][0],t[e+1][1]],r.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(e&&2===e.length){const t=n.maxRandomnessOffset;r.push({op:"lineTo",data:[e[0]+F(t,n),e[1]+F(t,n)]})}}else 3===s?(r.push({op:"move",data:[t[1][0],t[1][1]]}),r.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===s&&(r=r.concat(N(t[0][0],t[0][1],t[1][0],t[1][1],n)));return r}function $(t,e,n,s,r,i,a,o){const h=F(.5,o)-Math.PI/2,c=[];c.push([F(i,o)+e+.9*s*Math.cos(h-t),F(i,o)+n+.9*r*Math.sin(h-t)]);for(let a=h;a<2*Math.PI+h-.01;a+=t)c.push([F(i,o)+e+s*Math.cos(a),F(i,o)+n+r*Math.sin(a)]);return c.push([F(i,o)+e+s*Math.cos(h+2*Math.PI+.5*a),F(i,o)+n+r*Math.sin(h+2*Math.PI+.5*a)]),c.push([F(i,o)+e+.98*s*Math.cos(h+a),F(i,o)+n+.98*r*Math.sin(h+a)]),c.push([F(i,o)+e+.9*s*Math.cos(h+.5*a),F(i,o)+n+.9*r*Math.sin(h+.5*a)]),q(c,null,o)}function H(t,e,n,s,r,i,a,o,h){const c=i+F(.1,h),l=[];l.push([F(o,h)+e+.9*s*Math.cos(c-t),F(o,h)+n+.9*r*Math.sin(c-t)]);for(let i=c;i<=a;i+=t)l.push([F(o,h)+e+s*Math.cos(i),F(o,h)+n+r*Math.sin(i)]);return l.push([e+s*Math.cos(a),n+r*Math.sin(a)]),l.push([e+s*Math.cos(a),n+r*Math.sin(a)]),q(l,null,h)}function B(t,e,n,s,r,i,a,o){const h=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.5];let l=[0,0];for(let u=0;u<2;u++)0===u?h.push({op:"move",data:[a.x,a.y]}):h.push({op:"move",data:[a.x+F(c[0],o),a.y+F(c[0],o)]}),l=[r+F(c[u],o),i+F(c[u],o)],h.push({op:"bcurveTo",data:[t+F(c[u],o),e+F(c[u],o),n+F(c[u],o),s+F(c[u],o),l[0],l[1]]});return a.setPosition(l[0],l[1]),h}function U(t,e,n,s){let r=[];switch(e.key){case"M":case"m":{const n="m"===e.key;if(e.data.length>=2){let i=+e.data[0],a=+e.data[1];n&&(i+=t.x,a+=t.y);const o=1*(s.maxRandomnessOffset||0);i+=F(o,s),a+=F(o,s),t.setPosition(i,a),r.push({op:"move",data:[i,a]})}break}case"L":case"l":{const n="l"===e.key;if(e.data.length>=2){let i=+e.data[0],a=+e.data[1];n&&(i+=t.x,a+=t.y),r=r.concat(N(t.x,t.y,i,a,s)),t.setPosition(i,a)}break}case"H":case"h":{const n="h"===e.key;if(e.data.length){let i=+e.data[0];n&&(i+=t.x),r=r.concat(N(t.x,t.y,i,t.y,s)),t.setPosition(i,t.y)}break}case"V":case"v":{const n="v"===e.key;if(e.data.length){let i=+e.data[0];n&&(i+=t.y),r=r.concat(N(t.x,t.y,t.x,i,s)),t.setPosition(t.x,i)}break}case"Z":case"z":t.first&&(r=r.concat(N(t.x,t.y,t.first[0],t.first[1],s)),t.setPosition(t.first[0],t.first[1]),t.first=null);break;case"C":case"c":{const n="c"===e.key;if(e.data.length>=6){let i=+e.data[0],a=+e.data[1],o=+e.data[2],h=+e.data[3],c=+e.data[4],l=+e.data[5];n&&(i+=t.x,o+=t.x,c+=t.x,a+=t.y,h+=t.y,l+=t.y);const u=B(i,a,o,h,c,l,t,s);r=r.concat(u),t.bezierReflectionPoint=[c+(c-o),l+(l-h)]}break}case"S":case"s":{const i="s"===e.key;if(e.data.length>=4){let a=+e.data[0],o=+e.data[1],h=+e.data[2],c=+e.data[3];i&&(a+=t.x,h+=t.x,o+=t.y,c+=t.y);let l=a,u=o;const p=n?n.key:"";let f=null;"c"!==p&&"C"!==p&&"s"!==p&&"S"!==p||(f=t.bezierReflectionPoint),f&&(l=f[0],u=f[1]);const d=B(l,u,a,o,h,c,t,s);r=r.concat(d),t.bezierReflectionPoint=[h+(h-a),c+(c-o)]}break}case"Q":case"q":{const n="q"===e.key;if(e.data.length>=4){let i=+e.data[0],a=+e.data[1],o=+e.data[2],h=+e.data[3];n&&(i+=t.x,o+=t.x,a+=t.y,h+=t.y);const c=1*(1+.2*s.roughness),l=1.5*(1+.22*s.roughness);r.push({op:"move",data:[t.x+F(c,s),t.y+F(c,s)]});let u=[o+F(c,s),h+F(c,s)];r.push({op:"qcurveTo",data:[i+F(c,s),a+F(c,s),u[0],u[1]]}),r.push({op:"move",data:[t.x+F(l,s),t.y+F(l,s)]}),u=[o+F(l,s),h+F(l,s)],r.push({op:"qcurveTo",data:[i+F(l,s),a+F(l,s),u[0],u[1]]}),t.setPosition(u[0],u[1]),t.quadReflectionPoint=[o+(o-i),h+(h-a)]}break}case"T":case"t":{const i="t"===e.key;if(e.data.length>=2){let a=+e.data[0],o=+e.data[1];i&&(a+=t.x,o+=t.y);let h=a,c=o;const l=n?n.key:"";let u=null;"q"!==l&&"Q"!==l&&"t"!==l&&"T"!==l||(u=t.quadReflectionPoint),u&&(h=u[0],c=u[1]);const p=1*(1+.2*s.roughness),f=1.5*(1+.22*s.roughness);r.push({op:"move",data:[t.x+F(p,s),t.y+F(p,s)]});let d=[a+F(p,s),o+F(p,s)];r.push({op:"qcurveTo",data:[h+F(p,s),c+F(p,s),d[0],d[1]]}),r.push({op:"move",data:[t.x+F(f,s),t.y+F(f,s)]}),d=[a+F(f,s),o+F(f,s)],r.push({op:"qcurveTo",data:[h+F(f,s),c+F(f,s),d[0],d[1]]}),t.setPosition(d[0],d[1]),t.quadReflectionPoint=[a+(a-h),o+(o-c)]}break}case"A":case"a":{const n="a"===e.key;if(e.data.length>=7){const i=+e.data[0],a=+e.data[1],o=+e.data[2],h=+e.data[3],c=+e.data[4];let u=+e.data[5],p=+e.data[6];if(n&&(u+=t.x,p+=t.y),u===t.x&&p===t.y)break;if(0===i||0===a)r=r.concat(N(t.x,t.y,u,p,s)),t.setPosition(u,p);else for(let e=0;e<1;e++){const e=new l([t.x,t.y],[u,p],[i,a],o,!!h,!!c);let n=e.getNextSegment();for(;n;){const i=B(n.cp1[0],n.cp1[1],n.cp2[0],n.cp2[1],n.to[0],n.to[1],t,s);r=r.concat(i),n=e.getNextSegment()}}}break}}return r}var X=Object.freeze({line:O,linearPath:L,polygon:A,rectangle:function(t,e,n,s,r){return A([[t,e],[t+n,e],[t+n,e+s],[t,e+s]],r)},curve:function(t,e){const n=G(t,1*(1+.2*e.roughness),e),s=G(t,1.5*(1+.22*e.roughness),e);return{type:"path",ops:n.concat(s)}},ellipse:C,arc:function(t,e,n,s,r,i,a,o,h){const c=t,l=e;let u=Math.abs(n/2),p=Math.abs(s/2);u+=F(.01*u,h),p+=F(.01*p,h);let f=r,d=i;for(;f<0;)f+=2*Math.PI,d+=2*Math.PI;d-f>2*Math.PI&&(f=0,d=2*Math.PI);const y=2*Math.PI/h.curveStepCount,g=Math.min(y/2,(d-f)/2),v=H(g,c,l,u,p,f,d,1,h),x=H(g,c,l,u,p,f,d,1.5,h);let w=v.concat(x);return a&&(o?w=(w=w.concat(N(c,l,c+u*Math.cos(f),l+p*Math.sin(f),h))).concat(N(c,l,c+u*Math.cos(d),l+p*Math.sin(d),h)):(w.push({op:"lineTo",data:[c,l]}),w.push({op:"lineTo",data:[c+u*Math.cos(f),l+p*Math.sin(f)]}))),{type:"path",ops:w}},svgPath:function(t,e){t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let n=new c(t);if(e.simplification){const t=new class{constructor(t,e){this.sets=t,this.closed=e}fit(t){const e=[];for(const n of this.sets){const s=n.length;let r=Math.floor(t*s);if(r<5){if(s<=5)continue;r=5}e.push(this.reduce(n,r))}let n="";for(const t of e){for(let e=0;e<t.length;e++){const s=t[e];n+=0===e?"M"+s[0]+","+s[1]:"L"+s[0]+","+s[1]}this.closed&&(n+="z ")}return n}distance(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}reduce(t,e){if(t.length<=e)return t;const n=t.slice(0);for(;n.length>e;){let t=-1,e=-1;for(let s=1;s<n.length-1;s++){const r=this.distance(n[s-1],n[s]),i=this.distance(n[s],n[s+1]),a=this.distance(n[s-1],n[s+1]),o=(r+i+a)/2,h=Math.sqrt(o*(o-r)*(o-i)*(o-a));(t<0||h<t)&&(t=h,e=s)}if(!(e>0))break;n.splice(e,1)}return n}}(n.linearPoints,n.closed).fit(e.simplification);n=new c(t)}let s=[];const r=n.segments||[];for(let t=0;t<r.length;t++){const i=U(n,r[t],t>0?r[t-1]:null,e);i&&i.length&&(s=s.concat(i))}return{type:"path",ops:s}},solidFillPolygon:function(t,e){const n=[];if(t.length){const s=e.maxRandomnessOffset||0,r=t.length;if(r>2){n.push({op:"move",data:[t[0][0]+F(s,e),t[0][1]+F(s,e)]});for(let i=1;i<r;i++)n.push({op:"lineTo",data:[t[i][0]+F(s,e),t[i][1]+F(s,e)]})}}return{type:"fillPath",ops:n}},patternFillPolygon:R,patternFillEllipse:function(t,e,n,s,r){return S(r,T).fillEllipse(t,e,n,s,r)},patternFillArc:function(t,e,n,s,r,i,a){const o=S(a,T).fillArc(t,e,n,s,r,i,a);if(o)return o;const h=t,c=e;let l=Math.abs(n/2),u=Math.abs(s/2);l+=F(.01*l,a),u+=F(.01*u,a);let p=r,f=i;for(;p<0;)p+=2*Math.PI,f+=2*Math.PI;f-p>2*Math.PI&&(p=0,f=2*Math.PI);const d=(f-p)/a.curveStepCount,y=[];for(let t=p;t<=f;t+=d)y.push([h+l*Math.cos(t),c+u*Math.sin(t)]);return y.push([h+l*Math.cos(f),c+u*Math.sin(f)]),y.push([h,c]),R(y,a)},randOffset:z,randOffsetWithRange:D,doubleLineOps:j});class V extends e{constructor(t,e){super(t,e),t&&t.workerURL?this.renderer=function(t){let e,a;if("function"==typeof t){const n=Function.prototype.toString;e=a=URL.createObjectURL(new Blob([`${n.call(r)}\n(${n.call(i)})(${n.call(t)})`]))}else"string"==typeof t&&(e=t,0===t.indexOf("blob:")&&(a=e));if(e){let t=new Worker(e);return a&&(t.oURL=a),n(new s(t))}throw"Workly only supports functions, classes, urls"}(t.workerURL):this.renderer=X}async line(t,e,n,s,r){const i=this._options(r);return this._drawable("line",[await this.renderer.line(t,e,n,s,i)],i)}async rectangle(t,e,n,s,r){const i=this._options(r),a=[];if(i.fill){const r=[[t,e],[t+n,e],[t+n,e+s],[t,e+s]];"solid"===i.fillStyle?a.push(await this.renderer.solidFillPolygon(r,i)):a.push(await this.renderer.patternFillPolygon(r,i))}return a.push(await this.renderer.rectangle(t,e,n,s,i)),this._drawable("rectangle",a,i)}async ellipse(t,e,n,s,r){const i=this._options(r),a=[];if(i.fill)if("solid"===i.fillStyle){const r=await this.renderer.ellipse(t,e,n,s,i);r.type="fillPath",a.push(r)}else a.push(await this.renderer.patternFillEllipse(t,e,n,s,i));return a.push(await this.renderer.ellipse(t,e,n,s,i)),this._drawable("ellipse",a,i)}async circle(t,e,n,s){const r=await this.ellipse(t,e,n,n,s);return r.shape="circle",r}async linearPath(t,e){const n=this._options(e);return this._drawable("linearPath",[await this.renderer.linearPath(t,!1,n)],n)}async arc(t,e,n,s,r,i,a=!1,o){const h=this._options(o),c=[];if(a&&h.fill)if("solid"===h.fillStyle){const a=await this.renderer.arc(t,e,n,s,r,i,!0,!1,h);a.type="fillPath",c.push(a)}else c.push(await this.renderer.patternFillArc(t,e,n,s,r,i,h));return c.push(await this.renderer.arc(t,e,n,s,r,i,a,!0,h)),this._drawable("arc",c,h)}async curve(t,e){const n=this._options(e);return this._drawable("curve",[await this.renderer.curve(t,n)],n)}async polygon(t,e){const n=this._options(e),s=[];if(n.fill)if("solid"===n.fillStyle)s.push(await this.renderer.solidFillPolygon(t,n));else{const e=this.computePolygonSize(t),r=[[0,0],[e[0],0],[e[0],e[1]],[0,e[1]]],i=await this.renderer.patternFillPolygon(r,n);i.type="path2Dpattern",i.size=e,i.path=this.polygonPath(t),s.push(i)}return s.push(await this.renderer.linearPath(t,!0,n)),this._drawable("polygon",s,n)}async path(t,e){const n=this._options(e),s=[];if(!t)return this._drawable("path",s,n);if(n.fill)if("solid"===n.fillStyle){const e={type:"path2Dfill",path:t,ops:[]};s.push(e)}else{const e=this.computePathSize(t),r=[[0,0],[e[0],0],[e[0],e[1]],[0,e[1]]],i=await this.renderer.patternFillPolygon(r,n);i.type="path2Dpattern",i.size=e,i.path=t,s.push(i)}return s.push(await this.renderer.svgPath(t,n)),this._drawable("path",s,n)}}const Y="undefined"!=typeof document;class Q{constructor(t){this.canvas=t,this.ctx=this.canvas.getContext("2d")}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),s=this.ctx;for(const t of e)switch(t.type){case"path":s.save(),s.strokeStyle=n.stroke,s.lineWidth=n.strokeWidth,this._drawToContext(s,t),s.restore();break;case"fillPath":s.save(),s.fillStyle=n.fill||"",this._drawToContext(s,t),s.restore();break;case"fillSketch":this.fillSketch(s,t,n);break;case"path2Dfill":{this.ctx.save(),this.ctx.fillStyle=n.fill||"";const e=new Path2D(t.path);this.ctx.fill(e),this.ctx.restore();break}case"path2Dpattern":{const e=this.canvas.ownerDocument||Y&&document;if(e){const s=t.size,r=e.createElement("canvas"),i=r.getContext("2d"),a=this.computeBBox(t.path);a&&(a.width||a.height)?(r.width=this.canvas.width,r.height=this.canvas.height,i.translate(a.x||0,a.y||0)):(r.width=s[0],r.height=s[1]),this.fillSketch(i,t,n),this.ctx.save(),this.ctx.fillStyle=this.ctx.createPattern(r,"repeat");const o=new Path2D(t.path);this.ctx.fill(o),this.ctx.restore()}else console.error("Cannot render path2Dpattern. No defs/document defined.");break}}}computeBBox(t){if(Y)try{const e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg");n.setAttribute("width","0"),n.setAttribute("height","0");const s=self.document.createElementNS(e,"path");s.setAttribute("d",t),n.appendChild(s),document.body.appendChild(n);const r=s.getBBox();return document.body.removeChild(n),r}catch(t){}return null}fillSketch(t,e,n){let s=n.fillWeight;s<0&&(s=n.strokeWidth/2),t.save(),t.strokeStyle=n.fill||"",t.lineWidth=s,this._drawToContext(t,e),t.restore()}_drawToContext(t,e){t.beginPath();for(const n of e.ops){const e=n.data;switch(n.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"qcurveTo":t.quadraticCurveTo(e[0],e[1],e[2],e[3]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill():t.stroke()}}const Z="undefined"!=typeof document;class J{constructor(t){this.svg=t}get defs(){const t=this.svg.ownerDocument||Z&&document;if(t&&!this._defs){const e=t.createElementNS("http://www.w3.org/2000/svg","defs");this.svg.firstChild?this.svg.insertBefore(e,this.svg.firstChild):this.svg.appendChild(e),this._defs=e}return this._defs||null}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS("http://www.w3.org/2000/svg","g");for(const t of e){let e=null;switch(t.type){case"path":(e=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(t)),e.style.stroke=n.stroke,e.style.strokeWidth=n.strokeWidth+"",e.style.fill="none";break;case"fillPath":(e=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",this.opsToPath(t)),e.style.stroke="none",e.style.strokeWidth="0",e.style.fill=n.fill||null;break;case"fillSketch":e=this.fillSketch(s,t,n);break;case"path2Dfill":(e=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",t.path||""),e.style.stroke="none",e.style.strokeWidth="0",e.style.fill=n.fill||null;break;case"path2Dpattern":if(this.defs){const r=t.size,i=s.createElementNS("http://www.w3.org/2000/svg","pattern"),a=`rough-${Math.floor(Math.random()*(Number.MAX_SAFE_INTEGER||999999))}`;i.setAttribute("id",a),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("width","1"),i.setAttribute("height","1"),i.setAttribute("height","1"),i.setAttribute("viewBox",`0 0 ${Math.round(r[0])} ${Math.round(r[1])}`),i.setAttribute("patternUnits","objectBoundingBox");const o=this.fillSketch(s,t,n);i.appendChild(o),this.defs.appendChild(i),(e=s.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d",t.path||""),e.style.stroke="none",e.style.strokeWidth="0",e.style.fill=`url(#${a})`}else console.error("Cannot render path2Dpattern. No defs/document defined.")}e&&r.appendChild(e)}return r}fillSketch(t,e,n){let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);const r=t.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",this.opsToPath(e)),r.style.stroke=n.fill||null,r.style.strokeWidth=s+"",r.style.fill="none",r}}return{canvas:(t,e)=>new class extends Q{constructor(t,e){super(t),this.gen=new V(e||null,this.canvas)}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}async line(t,e,n,s,r){const i=await this.gen.line(t,e,n,s,r);return this.draw(i),i}async rectangle(t,e,n,s,r){const i=await this.gen.rectangle(t,e,n,s,r);return this.draw(i),i}async ellipse(t,e,n,s,r){const i=await this.gen.ellipse(t,e,n,s,r);return this.draw(i),i}async circle(t,e,n,s){const r=await this.gen.circle(t,e,n,s);return this.draw(r),r}async linearPath(t,e){const n=await this.gen.linearPath(t,e);return this.draw(n),n}async polygon(t,e){const n=await this.gen.polygon(t,e);return this.draw(n),n}async arc(t,e,n,s,r,i,a=!1,o){const h=await this.gen.arc(t,e,n,s,r,i,a,o);return this.draw(h),h}async curve(t,e){const n=await this.gen.curve(t,e);return this.draw(n),n}async path(t,e){const n=await this.gen.path(t,e);return this.draw(n),n}}(t,e),svg:(t,e)=>new class extends J{constructor(t,e){super(t),this.gen=new V(e||null,this.svg)}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t){return this.gen.opsToPath(t)}async line(t,e,n,s,r){const i=await this.gen.line(t,e,n,s,r);return this.draw(i)}async rectangle(t,e,n,s,r){const i=await this.gen.rectangle(t,e,n,s,r);return this.draw(i)}async ellipse(t,e,n,s,r){const i=await this.gen.ellipse(t,e,n,s,r);return this.draw(i)}async circle(t,e,n,s){const r=await this.gen.circle(t,e,n,s);return this.draw(r)}async linearPath(t,e){const n=await this.gen.linearPath(t,e);return this.draw(n)}async polygon(t,e){const n=await this.gen.polygon(t,e);return this.draw(n)}async arc(t,e,n,s,r,i,a=!1,o){const h=await this.gen.arc(t,e,n,s,r,i,a,o);return this.draw(h)}async curve(t,e){const n=await this.gen.curve(t,e);return this.draw(n)}async path(t,e){const n=await this.gen.path(t,e);return this.draw(n)}}(t,e),generator:(t,e)=>new V(t,e)}}()},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}t.exports=function(t,e,s){return e&&n(t.prototype,e),s&&n(t,s),t}},function(t,e,n){t.exports=n(18)},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var s=n(23).Symbol;t.exports=s},function(t,e){function n(t,e,n,s,r,i,a){try{var o=t[i](a),h=o.value}catch(t){return void n(t)}o.done?e(h):Promise.resolve(h).then(s,r)}t.exports=function(t){return function(){var e=this,s=arguments;return new Promise(function(r,i){var a=t.apply(e,s);function o(t){n(a,r,i,o,h,"next",t)}function h(t){n(a,r,i,o,h,"throw",t)}o(void 0)})}}},function(t,e,n){"use strict";n.r(e);var s=n(5),r=n.n(s),i=n(1),a=n.n(i),o=n(12),h=n.n(o),c=n(10),l=n.n(c),u=n(9),p=n.n(u),f=n(4),d=n.n(f),y=n(8),g=n.n(y),v=n(0),x=n.n(v),w=n(6),m=n.n(w),b=n(2),M=n.n(b),_=n(3),P=n.n(_),k=n(7),E=n.n(k),S=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0";a()(this,t),this.x=parseFloat(e),this.y=parseFloat(n),this.z=parseFloat(s)},T=function t(e,n,s,r){var i=this;a()(this,t),x()(this,"render",function(t,e,n){t.clearRect(0,0,2*e,2*n);var s=i.faces,r=i.faces.length;s.sort(function(t,e){return t[0].y+t[1].y+t[2].y+t[3].y-(e[0].y+e[1].y+e[2].y+e[3].y)});for(var a=0;a<r;++a){var o=s[a];t.beginPath(),t.fillStyle=i.facecolor[a];for(var h=0,c=o.length;h<c;++h){var l=i.project(o[h]);0==h?t.moveTo(l.x+e,l.y+n):t.lineTo(l.x+e,l.y+n)}t.closePath(),t.stroke(),t.fill()}}),x()(this,"project",function(t){return new S(t.x,t.z)}),x()(this,"rotate",function(t,e){for(var n=i.center,s=0;s<8;s++){var r=i.vertices[s],a=Math.cos(t),o=Math.sin(t),h=Math.cos(e),c=Math.sin(e),l=r.x-n.x,u=r.y-n.y,p=r.z-n.z;r.x=a*l-o*h*u+o*c*p+n.x,r.y=o*l+a*h*u-a*c*p+n.y,r.z=c*u+h*p+n.z}}),x()(this,"rotate1",function(t,e){for(var n=i.center,s=new S(0,1,0),r=0;r<8;r++){var a=i.vertices[r],o=Math.sqrt((Math.pow(s.x,2)+Math.pow(s.y,2))/(Math.pow(s.x,2)+Math.pow(s.y,2)+Math.pow(s.z,2))),h=Math.sqrt(Math.pow(s.z,2)/(Math.pow(s.x,2)+Math.pow(s.y,2)+Math.pow(s.z,2))),c=Math.sqrt(Math.pow(s.y,2)/(Math.pow(s.x,2)+Math.pow(s.y,2))),l=o*Math.sqrt(Math.pow(s.x,2)/(Math.pow(s.x,2)+Math.pow(s.y,2))),u=o*c,p=h,f=Math.pow(l,2),d=Math.pow(u,2),y=Math.pow(p,2),g=Math.cos(t),v=Math.sin(t),x=a.x-n.x,w=a.y-n.y,m=a.z-n.z;a.x=(l*u*(1-g)-p*v)*x+(g+d*(1-g))*w+(p*u*(1-g)+l*v)*m+n.x,a.y=(g+f*(1-g))*x+(u*l*(1-g)+p*v)*w+(p*l*(1-g)-u*v)*m+n.y,a.z=(l*p*(1-g)+u*v)*x+(u*p*(1-g)-l*v)*w+(g+y*(1-g))*m+n.z}}),x()(this,"rotate2",function(t,e){for(var n=i.center,s=new S(0,0,10),r=0;r<8;r++){var a=i.vertices[r],o=-s.x,h=-s.y,c=s.z,l=Math.pow(o,2),u=Math.pow(h,2),p=Math.pow(c,2),f=l+u+p,d=Math.sqrt(l+u+p),y=Math.cos(t),g=Math.sin(t),v=a.x-n.x,x=a.y-n.y,w=a.z-n.z;a.x=(l+(u+p)*y)/f*v+(o*h*(1-y)-c*d*g)/f*x+(o*c*(1-y)+h*d*g)/f*w+n.x,a.y=(o*h*(1-y)+c*d*g)/f*v+(u+(l+p)*y)/f*x+(h*c*(1-y)-o*d*g)/f*w+n.y,a.z=(o*c*(1-y)-h*d*g)/f*v+(h*c*(1-y)+o*d*g)/f*x+(p+(l+u)*y)/f*w+n.z}}),this.center=new S(e,n,s),this.side=r;var o=r/2;this.vertices=[new S(this.center.x-o,this.center.y-o,this.center.z+o),new S(this.center.x-o,this.center.y-o,this.center.z-o),new S(this.center.x+o,this.center.y-o,this.center.z-o),new S(this.center.x+o,this.center.y-o,this.center.z+o),new S(this.center.x+o,this.center.y+o,this.center.z+o),new S(this.center.x+o,this.center.y+o,this.center.z-o),new S(this.center.x-o,this.center.y+o,this.center.z-o),new S(this.center.x-o,this.center.y+o,this.center.z+o)],this.facecolor=["rgba(227, 236, 236, 1)","rgba(0, 150, 255, 1)","rgba(158, 63, 34, 1)","rgba(41, 222, 80, 1)","rgba(231, 234, 32, 1)","rgba(226, 131, 14, 1)"],this.faces=[[this.vertices[0],this.vertices[1],this.vertices[2],this.vertices[3]],[this.vertices[3],this.vertices[2],this.vertices[5],this.vertices[4]],[this.vertices[4],this.vertices[5],this.vertices[6],this.vertices[7]],[this.vertices[7],this.vertices[6],this.vertices[1],this.vertices[0]],[this.vertices[7],this.vertices[0],this.vertices[3],this.vertices[4]],[this.vertices[1],this.vertices[6],this.vertices[5],this.vertices[2]]],console.log(this.faces)},O=function t(e,n){var s=this;a()(this,t),x()(this,"anchor",function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{stroke:"#ee6621"},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{scale:1,borderRadius:3},i=s;return{x:t,y:e,scale:r.scale||1,borderRadius:r.borderRadius||3,draw:function(){var s=[t,e],r=[t-10*this.scale,e+10*this.scale],a=[t+10*this.scale,e+10*this.scale],o=[[s[0]-this.borderRadius,s[1]],[s[0],s[1]-this.borderRadius],[s[0]+this.borderRadius,s[1]],[a[0]-this.borderRadius,a[1]-this.borderRadius],[a[0]-this.borderRadius,a[1]-this.borderRadius],[a[0],a[1]+this.borderRadius],[a[0]-2*this.borderRadius,a[1]+this.borderRadius],[r[0]+2*this.borderRadius,r[1]+this.borderRadius],[r[0]+2*this.borderRadius,r[1]+this.borderRadius],[r[0],r[1]+this.borderRadius],[r[0]+this.borderRadius,r[1]-this.borderRadius],[s[0]-this.borderRadius,s[1]]];i.draw.setStyle(n),i.ctx.beginPath(),i.ctx.moveTo(o[0][0],o[0][1]);for(var h=0;h<o.length-1;h+=4)i.ctx.quadraticCurveTo(o[h+1][0],o[h+1][1],o[h+2][0],o[h+2][1]),i.ctx.lineTo(o[h+3][0],o[h+3][1]);i.ctx.closePath(),i.draw.endToDraw(),i.ctx.restore()}}}),x()(this,"ball",function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=s;return{x:t,y:e,vx:i.vx||0,vy:i.vy||0,radius:n/2,update:function(t){var e=this;Object.keys(t).forEach(function(n){e[n]=t[n]})},draw:function(){a.draw.circle(this.x,this.y,n,r)}}}),x()(this,"smile",function(t,e,n,r){arguments.length>4&&void 0!==arguments[4]&&arguments[4];var i=s,a=t-n/4*2*.4,o=e-n/5,h=t+n/4*2*.4,c=e-n/5,l=t-n/4/2,u=e+n/5,p=t+n/4/2,f=e+n/5;return{x:t,y:e,draw:function(){i.draw.circle(this.x,this.y,n,r);var t=r.fill?Object.assign({},r,{fill:"",stroke:"#fff"}):r;i.draw.circle(a,o,n/7.5,t),i.draw.circle(h,c,n/7.5,t),i.draw.line(l,u,p,f,t)}}}),x()(this,"cube",function(t,e){var n=s;return{x:t||s.canvas.width,y:e||s.canvas.height,instance:null,mousedown:!1,draw:function(){var t=new T(0,100,0,50);this.instance=t,t.render(n.ctx,this.x,this.y)}}}),x()(this,"customShape",function(t,e,n){var i=s;return{onClick:n,draw:function(){var n;(n=i.draw)[t].apply(n,r()(e))}}}),this.canvas=e,this.ctx=e.getContext("2d"),this.draw=n},L=function t(e){var n=this;a()(this,t),x()(this,"grayscale",function(){for(var t=n.ctx.getImageData(0,0,n.canvas.width,n.canvas.height),e=t.data,s=0;s<e.length;s+=4){var r=(e[s]+e[s+1]+e[s+2])/3;e[s]=r,e[s+1]=r,e[s+2]=r}n.ctx.putImageData(t,0,0)}),x()(this,"invert",function(){for(var t=n.ctx.getImageData(0,0,n.canvas.width,n.canvas.height),e=t.data,s=0;s<e.length;s+=4)e[s]=255-e[s],e[s+1]=255-e[s+1],e[s+2]=255-e[s+2];n.ctx.putImageData(t,0,0)}),this.canvas=e,this.ctx=e.getContext("2d")},A=function t(e){var n=this;a()(this,t),x()(this,"draw",function(t){n.clear(),t.draw(),t.x+=t.vx,t.y+=t.vy,(t.y+t.vy>n.canvas.height||t.y+t.vy<0)&&(t.vy=-t.vy),(t.x+t.vx>n.canvas.width||t.x+t.vx<0)&&(t.vx=-t.vx),n.raf=window.requestAnimationFrame(function(){return n.draw(t)})}),x()(this,"clear",function(){n.ctx.fillStyle="rgba(255,255,255,0.3)",n.ctx.fillRect(0,0,n.canvas.width,n.canvas.height)}),x()(this,"longTailEffect",function(t){var e=!1;n.canvas.addEventListener("mousemove",function(n){e||(this.clear(),t.x=n.clientX,t.y=n.clientY,t.draw())}),n.canvas.addEventListener("click",function(n){var s=this;e||(this.raf=window.requestAnimationFrame(function(){return s.draw(t)}),e=!0)}),n.canvas.addEventListener("mouseout",function(t){window.cancelAnimationFrame(this.raf),e=!1})}),x()(this,"readsColor",function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=n.ctx.getImageData(0,0,n.canvas.width,n.canvas.height);return r.data[4*((t-1)*r.width+(e-1))-1+s]}),x()(this,"drawPixelColor",function(t){if(!t)return null;var e=t.layerX,s=t.layerY,r=n.ctx.getImageData(e,s,1,1).data,i="rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]/255+")";return console.log("%c".concat(i),"color: ".concat(i)),i}),x()(this,"offcreenRender",function(t){var e={};e.offscreenCanvas=t,e.offscreenCanvas.width=e.width,e.offscreenCanvas.height=e.height,e.offscreenContext=e.offscreenCanvas.getContext("2d")}),x()(this,"addMouseEvent",function(t,e,s){var r=!1,i=function(t){r&&e(t)},a=function t(e){r=!1,document.removeEventListener("mouseup",t,!1),document.removeEventListener("mousemove",i,!1),s(e)};n.canvas.addEventListener("mousedown",function(e){r=!0,t(e,function(){document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",a,!1)})})}),x()(this,"addClickEvent",function(){n.canvas.addEventListener("click",function(t){t.clientX,t.clientY})}),this.canvas=e,this.ctx=e.getContext("2d")},C=(n(14),["","#FB1808","#FEEF0B","#30FF07","#1DE5FE","#0031FF","#FB00E3","#FB001F","#FB1808","#FEEF0B","#30FF07","#1DE5FE","#0031FF","#FB00E3"]),R=function(t){function e(t,n){var s;return a()(this,e),(s=l()(this,p()(e).call(this))).canvas=t,s.ctx=t.getContext("2d"),s.raf=null,s.initStyle(n||{}),s.atomic=new O(t,d()(s)),s.filter=new L(t,d()(s)),s.tools=new A(t,d()(s)),s}return g()(e,t),e}(function t(e,n){var s=this;a()(this,t),x()(this,"initStyle",function(t){if(!t||!s.ctx)return null;s.rainbow=t.rainbow,s.screenWidth=t.screenWidth||800,s.screenHeight=t.screenHeight||800,s.ctx.lineCap="round",s.ctx.lineJoin="round",s.setStyle(t)}),x()(this,"setStyle",function(t){if(!t||!s.ctx)return null;s.styleType=[],t.fill&&s.styleType.push("fill"),t.stroke&&s.styleType.push("stroke"),s.ctx.strokeStyle=t.stroke||"#000000",s.ctx.fillStyle=t.fill||"#cc0000",s.ctx.lineWidth=t.strokeWidth||3}),x()(this,"endToDraw",function(){s.styleType.length?s.styleType.forEach(function(t){s.ctx[t]()}):s.ctx.stroke()}),x()(this,"rectangle",function(t,e,n,r,i){s.setStyle(i),s.ctx.beginPath(),s.ctx.rect(t,e,n,r),s.endToDraw()}),x()(this,"line",function(t,e,n,r,i){s.setStyle(i),s.ctx.beginPath(),s.ctx.moveTo(t,e),s.ctx.lineTo(n,r),s.endToDraw()}),x()(this,"circle",function(t,e,n,r){s.setStyle(r),s.ctx.beginPath(),s.ctx.arc(t,e,n/2,0,360*Math.PI/180),s.endToDraw()}),x()(this,"arc",function(t,e,n,r,i){s.setStyle(i),s.ctx.beginPath(),s.ctx.translate(t,e);var a=Math.sqrt(Math.pow(t-n,2)+Math.pow(e-r,2));s.ctx.arc(t+(n-t)/2,e+(r-e)/2,a,0,2*Math.PI),s.endToDraw()}),x()(this,"ellipse",function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};s.setStyle(i);var a=.5*n,o=.6*r;s.ctx.save(),s.ctx.translate(t,e),i.rotate&&s.ctx.rotate(i.rotate*Math.PI/180),s.ctx.beginPath(),s.ctx.moveTo(0,o),s.ctx.bezierCurveTo(a/3,o,a,o/3*2,a,0),s.ctx.bezierCurveTo(a,-o/3*2,a/3,-o,0,-o),s.ctx.bezierCurveTo(-a/3,-o,-a,-o/3*2,-a,0),s.ctx.bezierCurveTo(-a,o/3,-a/3*2,o,0,o),s.ctx.closePath(),s.endToDraw(),s.ctx.restore()}),x()(this,"polygon",function(t,e){if(s.setStyle(e),P()(t[0])){var n;s.ctx.beginPath(),(n=s.ctx).moveTo.apply(n,r()(t[0]));for(var i=1;i<t.length;i++){var a;(a=s.ctx).lineTo.apply(a,r()(t[i]))}}else{var o=t[0],h=t[1],c=t[2],l=t[3],u=t[4],p=Math.sqrt(Math.pow(o-c,2)+Math.pow(h-l,2));s.ctx.save(),s.ctx.translate(o,h),s.ctx.rotate(Math.PI/2);var f=p*Math.cos(Math.PI/u),d=p*Math.sin(Math.PI/u);s.ctx.beginPath(),s.ctx.lineCap="round",s.ctx.moveTo(f,d);for(var y=0;y<=u;y++)s.ctx.rotate(2*Math.PI/u),s.ctx.lineTo(f,-d)}s.ctx.closePath(),s.endToDraw(),s.ctx.restore()}),x()(this,"curveTag",function(t,e,n,r,i){for(var a=[],o=0;o<(n-t)/7;o++){var h=t+n/100*o+10,c=30*Math.PI/180*o*20,l=e+Math.round(5*Math.sin(c));a.push([h,l])}s.curve(a,i)}),x()(this,"linearGradient",function(){s.canvasGradient=s.ctx.createLinearGradient(0,0,s.screenWidth,s.screenHeight),C.forEach(function(t,e){t&&s.canvasGradient.addColorStop(e/C.length,t)}),s.ctx.strokeStyle=s.canvasGradient}),x()(this,"linearPath",function(t,e){var n;s.setStyle(e),s.ctx.beginPath(),(n=s.ctx).moveTo.apply(n,r()(t[0]));for(var i=1;i<t.length;i++){var a;(a=s.ctx).lineTo.apply(a,r()(t[i]))}s.endToDraw(),s.ctx.restore()}),x()(this,"curve",function(t,e){s.setStyle(e);for(var n=0;n<t.length-1;n+=3)s.ctx.beginPath(),s.ctx.moveTo(t[n][0],t[n][1]),s.pen(t[n+1][0],t[n+1][1],t[n+2][0],t[n+2][1],e);s.endToDraw(),s.ctx.restore()}),x()(this,"pen",function(t,e,n,r,i){s.setStyle(i),s.rainbow&&s.linearGradient(),s.ctx.save(),s.ctx.quadraticCurveTo(t,e,n,r),s.endToDraw(),s.ctx.restore()}),x()(this,"image",function(t,e,n,r,i){return new Promise(function(a){var o=new Image;o.src=i,o.crossOrigin="Anonymous",o.onload=function(){s.ctx.drawImage(o,t,e,n,r),a()}})}),x()(this,"clear",function(){s.ctx.clearRect(0,0,s.screenWidth,s.screenHeight)}),x()(this,"eraser",function(t,e,n,r){s.ctx.clearRect(n-5,r-5,10,10)}),x()(this,"cut",function(t,e,n,r){s.ctx.save(),s.ctx.setLineDash([4,2]),s.ctx.beginPath(),s.ctx.lineWidth=1,s.ctx.rect(t,e,n-t,r-e),s.ctx.stroke(),s.ctx.restore()}),this.ctx=e,this.initStyle(n||{})}),z=n(11),D=n.n(z);var j=function(t,e){return Math.floor(Math.random()*(e-t)+t)},I=function(){var t=j(2,10);return Array(t).fill(0).map(function(){return[j(0,500),j(0,300)]})},F=function(t,e,n){var s=n.autoHeight,r=n.lineHeight,i={circle:function(){return[s/2+r,s/2+r,s,e]},ellipse:function(){return[1.5*s/2+r,s/2+r,1.5*s,s,e]},linearPath:function(){return[I()]},polygon:function(){return[I()]},curve:function(){return[I()]},arc:function(){return[j(50,500),j(50,500),j(100,200),j(100,200),-Math.PI*(2*Math.random()),Math.PI/(2*Math.random()),!!j(0,2),e]}};return i[t]?i[t]():[r,r,s,s,e]},N=function(t,e,n,s){return s.autoSort?function(t,e,n,s){var r=s.autoHeight,i=s.sortCount,a=s.lineHeight,o=r,h=Math.floor(t%i),c=Math.floor(t/i),l={circle:function(){var t=P()(n)?n.slice(0):F(e,n,{autoHeight:r,lineHeight:a});return t[0]=(o+a)*h+t[2]/2+a,t[1]=(r+a)*c+t[2]/2+a,t},ellipse:function(){var t=P()(n)?n.slice(0):F(e,n,{autoHeight:r,lineHeight:a});return t[0]=(o+a)*h+t[2]/2+a,t[1]=(r+a)*c+t[3]/2+a,t},linearPath:function(){var t=P()(n)?n.slice(0):F(e,n,{autoHeight:r,lineHeight:a});return t[0][0]=[(o+a)*h+a,(r+a)*c+a],t},polygon:function(){var t=P()(n)?n.slice(0):F(e,n,{autoHeight:r,lineHeight:a});return t[0][0]=[(o+a)*h+a,(r+a)*c+a],t},curve:function(){return n||F(e,n,{autoHeight:r,lineHeight:a})},arc:function(){return n||F(e,n,{autoHeight:r,lineHeight:a})}};if(l[e])return l[e]();var u=P()(n)?n.slice(0):F(e,n,{autoHeight:r,lineHeight:a});return u[0]=(o+a)*h+a,u[1]=(r+a)*c+a,u}(t,e,n,s):P()(n)?n:F(e,n,s)},W=(n(38),function(t){function e(t){var n;return a()(this,e),n=l()(this,p()(e).call(this,t)),x()(d()(n),"initEle",function(){n.canvas=document.getElementById(n.props.id||"canvas"),n.canvas.width=n.props.style.width||800,n.canvas.height=n.props.style.height||800,n.ctx=n.canvas.getContext("2d",n.props.canvasOptions),n.uc=new R(n.canvas),n.rc=D.a.canvas(n.canvas,{async:n.props.async}),n.startDraw(n.props.data)}),x()(d()(n),"startDraw",function(t){if(n.props.render&&n.props.render(n.ctx,n.uc,n.canvas,n.rc),!n.uc||!t)return null;t.forEach(function(t,e){if(t)if(t.render)t.render(n.uc);else if(P()(t)&&(E()(t[0])||E()(t[1]))){(E()(t[0])?t[0]:t[1])(n.uc)}else if(P()(t)&&n.uc[t[0]]){var s=N(e,t[0],t[1],n.state);n.draw(t[0],s)}else if(n.uc[t.type]){var r=N(e,t.type,t.options,n.state);n.draw(t.type,r)}})}),x()(d()(n),"draw",function(t,e){var s;console.log(t,e),(s=n.uc)[t].apply(s,r()(e))}),n.state={autoHeight:t.autoHeight||60,lineHeight:t.lineHeight||20,sortCount:t.sortCount||1,autoSort:t.autoSort},n}return g()(e,t),h()(e,[{key:"componentDidMount",value:function(){this.initEle()}},{key:"render",value:function(){return m.a.createElement("div",{className:"draw-container",style:this.props.style},m.a.createElement("canvas",{id:this.props.id||"canvas",style:this.props.style},this.props.children))}}]),e}(m.a.PureComponent));W.defaultProps={style:{},canvasOptions:{},data:[],render:function(){},children:null},W.propTypes={style:M.a.object,canvasOptions:M.a.object,data:M.a.array,render:M.a.func,children:M.a.element};var G=W,q=n(13),$=n.n(q),H=n(16),B=n.n(H),U=(n(33),function(t){function e(t){var n;return a()(this,e),n=l()(this,p()(e).call(this,t)),x()(d()(n),"initEle",function(t){if("canvas"===t){var e=document.getElementById("canvas");e.width=n.props.style.width||800,e.height=n.props.style.height||800,n.ctx=e.getContext("2d"),n.rc=D.a.canvas(e,{async:n.props.async}),n.rc.curveTag=n.curveTag,n.startDraw(n.props.data)}else n.props.type}),x()(d()(n),"startDraw",function(t){if(n.props.showDemo&&n.drawDemo(),n.props.render&&n.props.render(n.ctx,n.rc),!n.rc||!t)return null;t.forEach(function(t,e){if(t)if(console.log(t,e),t.render)t.render(n.rc);else if(P()(t)&&(E()(t[0])||E()(t[1]))){(E()(t[0])?t[0]:t[1])(n.rc)}else if(P()(t)&&n.rc[t[0]]){var s=N(e,t[0],t[1],n.state);n.draw(t[0],s)}else if(n.rc[t.type]){var r=N(e,t.type,t.options,n.state);n.draw(t.type,r)}})}),x()(d()(n),"draw",function(){var t=B()($.a.mark(function t(e,s){var i;return $.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(i=n.rc)[e].apply(i,r()(s));case 2:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),x()(d()(n),"drawDemo",function(){n.rc.rectangle(10,10,200,200),n.rc.circle(50,50,80,{fill:"red"}),n.rc.rectangle(120,15,80,80,{fill:"red"}),n.rc.circle(50,150,80,{fill:"rgb(10, 150, 80)",fillWeight:3}),n.rc.rectangle(220,15,80,80,{fill:"red",hachureAngle:60,hachureGap:8}),n.rc.rectangle(120,105,80,80,{fill:"rgba(255, 0, 200, 0.2)",fillStyle:"solid"}),n.rc.linearPath([[690,10],[790,20],[750,120],[690,100]])}),x()(d()(n),"curveTag",function(t,e,s,r,i){for(var a=[],o=0;o<(s-t)/7;o++){var h=t+s/100*o+10,c=30*Math.PI/180*o*20,l=e+Math.round(5*Math.sin(c));a.push([h,l])}n.rc.curve(a,i)}),n.state={autoHeight:t.autoHeight||60,lineHeight:t.lineHeight||20,sortCount:t.sortCount||1,autoSort:t.autoSort},n}return g()(e,t),h()(e,[{key:"componentDidMount",value:function(){this.initEle(this.props.type)}},{key:"render",value:function(){return m.a.createElement("div",{className:"rough-container",style:this.props.style},"canvas"===this.props.type?m.a.createElement("canvas",{id:"canvas",style:this.props.style}):m.a.createElement("svg",{style:this.props.style,id:"svg"}))}}]),e}(m.a.PureComponent));U.defaultProps={style:{},type:"canvas",data:[],showDemo:!1,autoSort:!1,sortCount:1,autoHeight:0,lineHeight:0,async:!1},U.propTypes={style:M.a.object,type:M.a.string.isRequired,data:M.a.array,showDemo:M.a.bool,autoSort:M.a.bool,sortCount:M.a.number,autoHeight:M.a.number,lineHeight:M.a.number,async:M.a.bool};var X=U;n(31);n.d(e,"Draw",function(){return V}),n.d(e,"Rough",function(){return Y});var V=G,Y=X},function(t,e,n){var s=function(t){"use strict";var e,n=Object.prototype,s=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function h(t,e,n,s){var r=e&&e.prototype instanceof y?e:y,i=Object.create(r.prototype),a=new S(s||[]);return i._invoke=function(t,e,n){var s=l;return function(r,i){if(s===p)throw new Error("Generator is already running");if(s===f){if("throw"===r)throw i;return O()}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var o=P(a,n);if(o){if(o===d)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===l)throw s=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=p;var h=c(t,e,n);if("normal"===h.type){if(s=n.done?f:u,h.arg===d)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(s=f,n.method="throw",n.arg=h.arg)}}}(t,n,a),i}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var l="suspendedStart",u="suspendedYield",p="executing",f="completed",d={};function y(){}function g(){}function v(){}var x={};x[i]=function(){return this};var w=Object.getPrototypeOf,m=w&&w(w(T([])));m&&m!==n&&s.call(m,i)&&(x=m);var b=v.prototype=y.prototype=Object.create(x);function M(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function _(t){var e;this._invoke=function(n,r){function i(){return new Promise(function(e,i){!function e(n,r,i,a){var o=c(t[n],t,r);if("throw"!==o.type){var h=o.arg,l=h.value;return l&&"object"==typeof l&&s.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(l).then(function(t){h.value=t,i(h)},function(t){return e("throw",t,i,a)})}a(o.arg)}(n,r,e,i)})}return e=e?e.then(i,i):i()}}function P(t,n){var s=t.iterator[n.method];if(s===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=c(s,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,d;var i=r.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function T(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,a=function n(){for(;++r<t.length;)if(s.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:O}}function O(){return{value:e,done:!0}}return g.prototype=b.constructor=v,v.constructor=g,v[o]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,o in t||(t[o]="GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},M(_.prototype),_.prototype[a]=function(){return this},t.AsyncIterator=_,t.async=function(e,n,s,r){var i=new _(h(e,n,s,r));return t.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},M(b),b[o]="Generator",b[i]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var s=e.pop();if(s in t)return n.value=s,n.done=!1,n}return n.done=!0,n}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&s.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(s,r){return o.type="throw",o.arg=t,n.next=s,r&&(n.method="next",n.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var h=s.call(a,"catchLoc"),c=s.call(a,"finallyLoc");if(h&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(h){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var s=n.completion;if("throw"===s.type){var r=s.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,s){return this.delegate={iterator:T(t),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=e),d}},t}(t.exports);try{regeneratorRuntime=s}catch(t){Function("r","regeneratorRuntime = r")(s)}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var s=n(15),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=s?s.toStringTag:void 0;t.exports=function(t){var e=i.call(t,o),n=t[o];try{t[o]=void 0;var s=!0}catch(t){}var r=a.call(t);return s&&(e?t[o]=n:delete t[o]),r}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(21))},function(t,e,n){var s=n(22),r="object"==typeof self&&self&&self.Object===Object&&self,i=s||r||Function("return this")();t.exports=i},function(t,e,n){var s=n(15),r=n(20),i=n(19),a="[object Null]",o="[object Undefined]",h=s?s.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?o:a:h&&h in Object(t)?r(t):i(t)}},function(t,e){function n(e,s){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,s)}t.exports=n},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=s=function(t){return n(t)}:t.exports=s=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},s(e)}t.exports=s},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},,function(t,e){},,function(t,e){},,,,,function(t,e){}])});
//# sourceMappingURL=index.js.map